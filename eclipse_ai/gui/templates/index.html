<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eclipse AI Testing GUI</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/hex-map.css">
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        eclipse: {
                            dark: '#0f172a',
                            darker: '#020617',
                            primary: '#6366f1',
                            secondary: '#8b5cf6',
                            accent: '#ec4899',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-eclipse-darker text-gray-100 font-sans">
    
    <!-- Header -->
    <header class="bg-eclipse-dark border-b border-gray-700 px-6 py-4 shadow-lg">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <h1 class="text-2xl font-bold bg-gradient-to-r from-eclipse-primary to-eclipse-accent bg-clip-text text-transparent">
                    Eclipse AI Testing GUI
                </h1>
                <span class="text-sm text-gray-400">v0.1.0</span>
            </div>
            <div class="flex items-center space-x-4">
                <div id="status-indicator" class="flex items-center space-x-2">
                    <div class="w-2 h-2 rounded-full bg-green-500"></div>
                    <span class="text-sm text-gray-400">Ready</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex h-[calc(100vh-73px)]">
        
        <!-- Left Panel: Board State with Tabs -->
        <div class="w-3/5 border-r border-gray-700 flex flex-col">
            <!-- Header with Tab Navigation -->
            <div class="bg-eclipse-dark px-4 py-3 border-b border-gray-700">
                <h2 class="text-lg font-semibold mb-3">Board State</h2>
                <div class="flex space-x-1" id="board-view-tabs">
                    <button class="board-tab active" data-view="map">
                        <span class="text-lg mr-1">üó∫Ô∏è</span> Map
                    </button>
                    <button class="board-tab" data-view="tech">
                        <span class="text-lg mr-1">üî¨</span> Tech Market
                    </button>
                    <button class="board-tab" data-view="players">
                        <span class="text-lg mr-1">üë•</span> Players
                    </button>
                </div>
            </div>
            
            <!-- Tab Contents -->
            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- Map View -->
                <div id="view-map" class="board-view-content flex-1 flex flex-col">
                    <!-- Map Controls -->
                    <div class="bg-eclipse-dark px-4 py-2 border-b border-gray-700 flex items-center justify-between">
                        <span class="text-sm text-gray-400">Hex Map</span>
                        <div class="flex space-x-2">
                            <button id="zoom-in" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm transition">+</button>
                            <button id="zoom-out" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm transition">‚àí</button>
                            <button id="reset-view" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm transition">Reset</button>
                        </div>
                    </div>
                    <!-- Hex Map Canvas -->
                    <div id="hex-map-container" class="flex-1 bg-eclipse-darker overflow-hidden relative">
                        <canvas id="board-canvas" class="w-full h-full"></canvas>
                    </div>
                    <!-- Hex Details Panel (shows selected hex info) -->
                    <div id="hex-details-panel" class="border-t border-gray-700 bg-eclipse-dark hidden max-h-64 overflow-y-auto">
                        <div class="px-4 py-2 border-b border-gray-700 flex items-center justify-between">
                            <h3 class="text-sm font-semibold" id="hex-details-title">Hex Details</h3>
                            <button id="hex-details-close" class="text-gray-400 hover:text-gray-200 text-lg">√ó</button>
                        </div>
                        <div id="hex-details-content" class="p-3 space-y-3">
                            <div id="hex-info" class="text-xs space-y-1"></div>
                            <div id="hex-planets" class="text-xs space-y-1"></div>
                            <div id="hex-ships" class="text-xs space-y-1"></div>
                            <div id="hex-tech" class="text-xs space-y-1"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Tech Market View -->
                <div id="view-tech" class="board-view-content hidden flex-1 overflow-y-auto bg-eclipse-darker">
                    <div class="p-4" id="tech-market-container">
                        <!-- Tech display will be rendered here -->
                    </div>
                </div>
                
                <!-- Players View -->
                <div id="view-players" class="board-view-content hidden flex-1 overflow-y-auto bg-eclipse-darker">
                    <div class="p-4" id="players-board-container">
                        <!-- Player tabs -->
                        <div id="player-tabs-board" class="flex space-x-1 overflow-x-auto mb-4"></div>
                        <!-- Player details -->
                        <div id="player-details-board"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel: Controls & Results -->
        <div class="w-2/5 flex flex-col overflow-hidden">
            
            <!-- State Editor -->
            <div class="flex-1 overflow-y-auto border-b border-gray-700">
                <div class="bg-eclipse-dark px-4 py-3 border-b border-gray-700 sticky top-0 z-10 flex items-center justify-between">
                    <h2 class="text-lg font-semibold">State Editor</h2>
                    <button id="toggle-state-editor" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm transition">
                        <span id="collapse-icon">‚àí</span>
                    </button>
                </div>
                <div id="state-editor-content" class="p-4 space-y-4">
                    
                    <!-- New Game Generator -->
                    <div class="bg-eclipse-dark rounded-lg p-4">
                        <label class="block text-sm font-medium mb-2">Generate New Game</label>
                        <div class="space-y-2">
                            <div class="flex space-x-2">
                                <div class="flex-1">
                                    <label class="block text-xs text-gray-400 mb-1">Players</label>
                                    <select id="num-players" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4" selected>4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                    </select>
                                </div>
                                <div class="flex-1">
                                    <label class="block text-xs text-gray-400 mb-1">Starting Round</label>
                                    <input type="number" id="starting-round" min="1" max="9" value="1" 
                                           class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                                </div>
                            </div>
                            <button id="generate-game-btn" class="w-full px-4 py-2 bg-eclipse-accent hover:bg-pink-600 rounded text-sm transition font-semibold">
                                New Game
                            </button>
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" id="ancient-homeworlds" class="w-4 h-4 bg-gray-700 border-gray-600 rounded focus:ring-2 focus:ring-eclipse-primary">
                                <label for="ancient-homeworlds" class="text-xs text-gray-300">Include Ancient Homeworlds (Rise of the Ancients)</label>
                            </div>
                            <details class="text-xs">
                                <summary class="cursor-pointer text-gray-400 hover:text-gray-300">Species Setup (optional)</summary>
                                <div id="species-setup" class="mt-2 space-y-1 max-h-32 overflow-y-auto">
                                    <!-- Species dropdowns will be populated here -->
                                </div>
                            </details>
                        </div>
                    </div>

                    <!-- Fixture Loader (Legacy) -->
                    <details class="bg-eclipse-dark rounded-lg p-4">
                        <summary class="cursor-pointer text-sm font-medium">Load Saved Fixture</summary>
                        <div class="mt-2">
                            <select id="fixture-select" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                                <option value="">Select a fixture...</option>
                            </select>
                        </div>
                    </details>

                    <!-- Round Control -->
                    <div class="bg-eclipse-dark rounded-lg p-4">
                        <label class="block text-sm font-medium mb-2">Game Round</label>
                        <div class="flex items-center space-x-2">
                            <button id="decrement-round" class="px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded transition">‚àí</button>
                            <input type="number" id="current-round" min="1" max="9" value="1" 
                                   class="flex-1 bg-gray-700 border border-gray-600 rounded px-3 py-2 text-center focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                            <button id="increment-round" class="px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded transition">+</button>
                        </div>
                    </div>

                    <!-- Tabs for State Editing -->
                    <div class="bg-eclipse-dark rounded-lg overflow-hidden">
                        <div class="flex border-b border-gray-700">
                            <button class="state-tab active flex-1 px-4 py-2 text-sm font-medium hover:bg-gray-700 transition" data-tab="players">
                                Players
                            </button>
                            <button class="state-tab flex-1 px-4 py-2 text-sm font-medium hover:bg-gray-700 transition" data-tab="tech">
                                Tech
                            </button>
                            <button class="state-tab flex-1 px-4 py-2 text-sm font-medium hover:bg-gray-700 transition" data-tab="json">
                                JSON
                            </button>
                        </div>
                        
                        <!-- Tab Content -->
                        <div class="p-4">
                            <div id="tab-players" class="tab-content">
                                <div id="players-editor" class="space-y-3"></div>
                            </div>
                            <div id="tab-tech" class="tab-content hidden">
                                <div id="tech-editor" class="space-y-3"></div>
                            </div>
                            <div id="tab-json" class="tab-content hidden">
                                <textarea id="json-editor" class="w-full h-64 bg-gray-800 border border-gray-600 rounded p-3 text-xs font-mono focus:outline-none focus:ring-2 focus:ring-eclipse-primary"></textarea>
                                <button id="apply-json" class="mt-2 px-4 py-2 bg-eclipse-primary hover:bg-eclipse-secondary rounded text-sm transition">
                                    Apply JSON Changes
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Save State -->
                    <div class="bg-eclipse-dark rounded-lg p-4">
                        <label class="block text-sm font-medium mb-2">Save State</label>
                        <div class="flex space-x-2">
                            <input id="save-filename" type="text" placeholder="my_state.json" class="flex-1 bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                            <button id="save-state-btn" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-sm transition">
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configuration Panel -->
            <div class="bg-eclipse-dark border-b border-gray-700">
                <div class="px-4 py-3 border-b border-gray-700 flex items-center justify-between">
                    <h2 class="text-lg font-semibold">Configuration</h2>
                    <button id="toggle-config-panel" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm transition">
                        <span id="config-collapse-icon">‚àí</span>
                    </button>
                </div>
                <div id="config-panel-content" class="p-4 space-y-4">
                    
                    <!-- Planner Settings -->
                    <div class="space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-xs font-medium mb-1">Simulations</label>
                                <input id="config-sims" type="number" value="600" min="10" max="10000" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                            </div>
                            <div>
                                <label class="block text-xs font-medium mb-1">Depth</label>
                                <input id="config-depth" type="number" value="3" min="1" max="10" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-xs font-medium mb-1">Strategy Profile</label>
                            <select id="config-profile" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                                <option value="">Default (Balanced)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-xs font-medium mb-1">Top K Plans</label>
                            <input id="config-topk" type="number" value="5" min="1" max="20" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-eclipse-primary">
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <input id="config-verbose" type="checkbox" class="w-4 h-4 bg-gray-700 border-gray-600 rounded focus:ring-2 focus:ring-eclipse-primary">
                            <label for="config-verbose" class="text-sm">Show detailed features</label>
                        </div>
                    </div>

                    <!-- Predict Button -->
                    <button id="predict-btn" class="w-full py-3 bg-gradient-to-r from-eclipse-primary to-eclipse-accent hover:from-eclipse-secondary hover:to-eclipse-primary rounded-lg font-semibold text-lg transition shadow-lg hover:shadow-xl">
                        Generate Predictions
                    </button>
                </div>
            </div>

            <!-- Results Display -->
            <div class="flex-1 overflow-y-auto">
                <div class="bg-eclipse-dark px-4 py-3 border-b border-gray-700 sticky top-0 z-10">
                    <h2 class="text-lg font-semibold">Results</h2>
                </div>
                <div id="results-container" class="p-4">
                    <div class="text-center text-gray-500 py-8">
                        <p class="text-sm">No predictions yet</p>
                        <p class="text-xs mt-1">Load a fixture and click "Generate Predictions"</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Toast Notifications Container -->
    <div id="toast-container" class="fixed bottom-4 right-4 space-y-2 z-50"></div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-eclipse-dark rounded-lg p-6 shadow-2xl">
            <div class="flex items-center space-x-4">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-eclipse-primary"></div>
                <span class="text-lg">Running planner...</span>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/ui-constants.js?v=20241117"></script>
    <script src="/static/js/api-client.js?v=20241113b"></script>
    <script src="/static/js/board-renderer.js?v=20241113"></script>
    <script src="/static/js/hex-details.js?v=20241113"></script>
    <script src="/static/js/player-panel.js?v=20241113"></script>
    <script src="/static/js/state-editor.js?v=20241113"></script>
    <script src="/static/js/config-panel.js?v=20241114"></script>
    <script src="/static/js/results-display.js?v=20241113e"></script>
    <script src="/static/js/board-view-manager.js?v=20241117"></script>
    <script src="/static/js/main.js?v=20241114"></script>

</body>
</html>

